<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="RecruitBoard">
	<select id="list_rb" parameterType="RecruitBoard" resultType="RecruitBoard">
		SELECT * FROM 
		(SELECT ROWNUM RN, A.* FROM (SELECT * FROM RECRUITBOARD WHERE RB_STATUS > 0 ORDER BY RB_NO DESC) A) 
		WHERE RN BETWEEN #{startRow} AND #{endRow}
	</select>
	<select id="detail_rb" parameterType="int" resultType="RecruitBoard">
		SELECT * FROM RECRUITBOARD WHERE RB_NO = #{rb_no} AND RB_STATUS > 0
	</select>
	<select id="cnt_rb" resultType="int">
		SELECT COUNT(*) FROM RECRUITBOARD WHERE RB_STATUS > 0	
	</select>
	<select id="search_rb" parameterType="RecruitBoard" resultType="RecruitBoard">
		<if test="${key == '1'}">
			SELECT * 
			FROM (SELECT ROWNUM RN, A.* FROM (SELECT * FROM RECRUITBOARD WHERE RB_STATUS > 0 ORDER BY RB_NO DESC) A) 
			WHERE RN BETWEEN #{startRow} AND #{endRow} AND U_ID LIKE '%'||#{keyword}||'%'
		</if>
		<if test="${key == '2'}">
			SELECT * 
			FROM (SELECT ROWNUM RN, A.* FROM (SELECT * FROM RECRUITBOARD WHERE RB_STATUS > 0 ORDER BY RB_NO DESC) A) 
			WHERE RN BETWEEN #{startRow} AND #{endRow} AND RB_NAME LIKE '%'||#{keyword}||'%'
		</if>
		<if test="${key == '3'}">
			SELECT * 
			FROM (SELECT ROWNUM RN, A.* FROM (SELECT * FROM RECRUITBOARD WHERE RB_STATUS > 0 ORDER BY RB_NO DESC) A) 
			WHERE RN BETWEEN #{startRow} AND #{endRow} AND RB_CONTENT LIKE '%'||#{keyword}||'%'
		</if>
		<if test="${key == '4'}">
			SELECT * 
			FROM (SELECT ROWNUM RN, A.* FROM (SELECT * FROM RECRUITBOARD WHERE RB_STATUS > 0 ORDER BY RB_NO DESC) A) 
			WHERE RN BETWEEN #{startRow} AND #{endRow} AND RB_CONTENT LIKE '%'||'#{keyword}'||'%' OR RB_NAME LIKE '%'||#{keyword}||'%'
		</if>
	</select>
	<update id="modify_rb" parameterType="RecruitBoard">
		UPDATE RECRUITBOARD 
		SET RB_NAME = #{rb_name}, RB_CONTENT = #{rb_content}, RB_RDATE = SYSTIMESTAMP - INTERVAL '1' minute 
		WHERE RB_NO = #{rb_no}
	</update>
	<update id="delete_rb" parameterType="int">
		UPDATE RECRUITBOARD SET RB_STATUS = 0 WHERE RB_NO = #{rb_no}
	</update>
	<update id="hit_rb" parameterType="int">
		UPDATE RECRUITBOARD SET RB_HIT = RB_HIT + 1 WHERE RB_NO = #{rb_no}
	</update>
	<insert id="write_rb" parameterType="RecruitBoard">
		INSERT INTO RECRUITBOARD (RB_NO, RB_NAME, RB_CONTENT, RB_STATUS, RB_HIT, U_ID)
        VALUES(RB_SQ.NEXTVAL, #{rb_name}, #{rb_content}, 1, 0, #{u_id})
	</insert>
</mapper>